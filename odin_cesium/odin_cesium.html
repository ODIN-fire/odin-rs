<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>odin_cesium - ODIN</title>


        <!-- Custom HTML head -->

        <meta name="description" content="the Open Data Integration Framework">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../odin.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">ODIN</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="odin_cesium"><a class="header" href="#odin_cesium">odin_cesium</a></h1>
<p>This is a system crate that depends on [<code>odin_server</code>], providing <code>odin_server::SpaService</code> implementations that are related to using
<a href="https://cesium.com/platform/cesiumjs/">CesiumJS</a> for user interfaces (UI) on top of a virtual globe display that is rendered by means
of <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API">WebGL</a> inside of a standard web browser.</p>
<p>This crate provides two main services:</p>
<ul>
<li><code>CesiumService</code> is responsible for providing the 3rd party CesiumJS code for the virtual globe rendering, and the
<code>odin-rs</code> specific user interface code that controls it. It also includes some general UI elements that are always
present (e.g. clock)</li>
<li><code>ImgLayerService</code> is a configurable service to provide and control background imagery from own and external (proxied) sources.
It is especially the layer that controls the map display</li>
</ul>
<h2 id="how-to-access-cesiumjs"><a class="header" href="#how-to-access-cesiumjs">How to access CesiumJS</a></h2>
<p>Since CesiumJS is a large 3rd party library we do support options for how it is accessed by the client. This can be either by</p>
<ul>
<li>directly downloading it from https://cesium.com/downloads/cesiumjs/releases/<version>/Build/Cesium,</li>
<li>proxying this URL with the <code>odin-rs</code> server - this is the default</li>
<li>providing it as a static asset from <ODIN-ROOT>/assets/odin_cesium/cesiumjs</li>
</ul>
<p>Those alternatives are controlled by the Cargo features <code>cesium_external</code>, <code>cesium_proxy</code> and <code>cesium_asset</code>.
Please note that crates depending on <code>odin_cesium</code> should support "pass-through" features in their respective <code>Cargo.toml</code> like so:</p>
<pre><code class="language-toml">...
[dependencies]
...
odin_cesium = { workspace = true }

[features]
...
cesium_asset = ["odin_cesium/cesium_asset"]
cesium_external = ["odin_cesium/cesium_external"]
</code></pre>
<p>There is no need to pass through <code>cesium_proxy</code> as it is the default. While this is convenient for setting up development
environments with minimal configuration this might cause reloading and should be avoided in a production environment.</p>
<p>To obtain, strip and store the requires cesium assets in <code>&lt;ODIN-ROOT&gt;/odin_cesium/cesiumjs/</code> we provide the
<code>install_cesium</code> binary tool, which you can run like so: <code>cargo run --bin install_cesium -- --version=&lt;cesium-version&gt;</code></p>
<p>In all cases the Cesium version to use is specified as a <code>CESIUM_VERSION</code> constant in <code>odin_orbital/src/lib.rs</code>. If you use
the <code>cesium_asset</code> option this has to correspond with the downloaded/installed version.</p>
<p>To see the current CesiumJS version please visit https://cesium.com/downloads/.</p>
<h2 id="testing-data-and-ui-rendering"><a class="header" href="#testing-data-and-ui-rendering">Testing Data and UI Rendering</a></h2>
<p>Since <a href="../odin_server/client.html">client side</a> <code>odin-rs</code> code is written in Javascript there is - depending on the development
environment in use - only limited type checking available. It is therefore good practice to test often and early, especially
since this applies to both the <a href="../odin_server/ui_library.html"><code>odin-rs</code> user interface</a> and to CesiumJS / WebGL based service-specific
data rendering.</p>
<p>To simplify testing of UI and rendering without a fully functional <code>SpaService</code> we provide the <code>cesium_test</code> tool. This is a
test harness for <code>odin-rs</code> Javascript modules that can make full use of the <code>odin-rs</code> <a href="../odin_server/ui_library.html">UI library</a> and
the CesiumJS library (including its <code>odin-rs</code> specific extensions in <code>odin_cesium.js</code>). The test module is provided as an explicit
file pathname when launching <code>cesium_test</code> like so:</p>
<pre><code class="language-shell">cargo run --bin cesium_test  --  &lt;JS-module-pathname&gt;
</code></pre>
<p>Test modules have to use the <code>exportFuncToMain(..)</code> function of <code>main.js</code> to set a global parameterless <code>start()</code> function that
can be triggered by a respective "start" button which is automatically added to the right of the icon box at the top of the page.
This function should in turn execute the behavior that is supposed to be tested. Look at the minimal <code>odin_cesium/test/test.js</code>
example for details:</p>
<pre><code class="language-javascript">import * as main from "../odin_server/main.js";

/* import on demand */
// import * as util from "../odin_server/ui_util.js";
// import * as data from "../odin_server/ui_data.js";
// import * as ui from "../odin_server/ui.js";
// import * as odinCesium from "./odin_cesium.js";

function start() {
    console.log("get started.");
    // trigger your real test here
}
main.exportFuncToMain(start);

// your test functions/data goes here...
</code></pre>
<p>Since <code>cesium_test</code> is a test and debug tool it automatically sets the <code>ODIN_RELOAD_ASSETS</code> environment variable used by
<a href="../odin_build/odin_build.html"><code>odin_build</code></a> and therefore it does not have to be relaunched if any of the involved Javascript
modules is changed - just refresh the page in the browser and hit "start" again to see the change effect.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../odin_server/ui_library.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../odin_share/odin_share.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../odin_server/ui_library.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../odin_share/odin_share.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
